####################################################################
## Jared Studyvin
## 9 June 2016
## This is a weight function for testing purposes
####################################################################

weightFun <- function(x,type='RP',inverse=FALSE,...){
### x is a vector of distances
### type indicates the plot type, FULL and RP are the only options
### inverse if true gives the inverse of the proportion of area searched as the distance x, otherwise the proportion of area searched is returned


    require(dplyr)

    ## If plot == 'FULL' then return 1 if x is in the interval (0,100], otherwise return 0
    if(toupper(type)=='FULL'){
        out <- rep(1,length(x))
        out[x>100|x<=0] <- 0
        return(out)
    }

### below is for  type == 'RP'

    ## turn the weight function into a step function
    x <- ceiling(x)

    ## the proportion of area searched at each distance band
    prop <- data.frame(d=1:100,prop=c(0.994938718149504,0.994624021920978,0.97823470461618,
                               0.903887671489263,0.781446817754437,0.660080011358875,
                                   0.536081699880172,0.409099290100651,0.29840175576812,
                                   0.189740873334674,0.111264971851594,0.0816700493858669,
                                   0.067700278957639,0.059958175937043,0.0545341895120893,
                                   0.0505828469268522,0.0475734802409185,0.0450099381748921,
                                   0.0423378182198427,0.0401874841234347,0.0385724876256597,
                                   0.0375685607674148,0.0379679064582935,0.0401752489037758,
                                   0.0424131471715669,0.0438726225903946,0.0447347583214495,
                                   0.0433469339543116,0.0412068218256184,0.0385248279209736,
                                   0.0365510108255672,0.0345598836947837,0.0324967362727387,
                                   0.0306221406330178,0.0293123303643584,0.0280691902067884,
                                   0.0269997951054828,0.0262282943445054,0.0254393320872947,
                                   0.0248405591169834, 0.0244960828525636,0.0242036187013642,
                                   0.0233586683041639,0.0226035346599462,0.0222185158984456,
                                   0.0214069613363088,0.020683810236012,0.0200167922196213,
                                   0.019411577915632,0.0187682283245286, 0.0182352956331142,
                                   0.0179184182081402,0.0178280820006544,0.0175513843953515,
                                   0.0173705435405511,0.016963286718304,0.0165774119064628,
                                   0.0161678252991839,0.0157737313237982,0.0153829454765745,
                                   0.0150233199416864,0.0147224581429039,0.014358043163838,
                                   0.0142845815296265,0.0141121743926314,0.0139173993754729,
                                   0.0136788604784495,0.013534509906191,0.0132257057163886,
                                   0.013059391311518,0.01309305396692,0.0130782401190816,
                                   0.0128978650101229,0.0127050541932945,0.0125310864539905,
                                   0.012462809770892,0.0125492535518906,0.0130525249770394,
                                   0.0132565365366079,0.0131972031553393,0.0131075146272192,
                                   0.0126218287678565,0.0120599362155872,0.0117114471331286,
                                   0.0114894197137408,0.011247687525456,0.0109519229419088,
                                   0.0109130541927116,0.0109879441900024,0.0110231274119703,
                                   0.0110033252854863,0.0108244349124521,0.0103993318123575,
                                   0.0102663216566701,0.0101761125809184,0.0100221948109964,
                                   0.00959313241747452,0.00889708968216072,0.00766000805175065,
                                   0.00598333373939794))

    ## merge distances x with the prop to get the proporatin of area search for each value of x
    out <- left_join(data.frame(d=x),prop,by=c('d'='d'))$prop

    ## na values indicate distances outside the interval (0,100] and the proportion of area searched is zero
    out[is.na(out)] <- 0

    ## invert the proportion of area search if desired but not the zero values
    if(inverse){
        out[out!=0] <- 1/out[out!=0]
    }

    return(out)
}
